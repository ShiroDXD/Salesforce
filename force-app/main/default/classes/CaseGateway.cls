public without sharing class CaseGateway {
    
     //Method to update Job Number on Job which is treated as Auto Number
    public static void generateCaseAutoNumber(List<Case> CaseList) {

        //System.debug('CaseList: ' + CaseList);

        Email_Case_Number_Prefix__c emailCaseNumber = Email_Case_Number_Prefix__c.getInstance();
        Manual_Case_Number_Prefix__c manualCaseNumber = Manual_Case_Number_Prefix__c.getInstance();
        Phone_Case_Number_Prefix__c phoneCaseNumber = Phone_Case_Number_Prefix__c.getInstance();
        WalkIn_Case_Number_Prefix__c walkInCaseNumber = WalkIn_Case_Number_Prefix__c.getInstance();
        Web_Case_Email_Prefix__c webCaseEmail = Web_Case_Email_Prefix__c.getInstance();
        //system.debug('Web Case Email Last_Value__c ' + webCaseEmail.Last_Value__c);
        

        decimal autoNumber;
        
        //Update Case Number
        for(Case caseRecord : CaseList){
            //system.debug('Email ' + caseRecord.Origin.equalsIgnoreCase(emailCaseNumber.Entry_Source__c));
            ///system.debug('origin ' + caseRecord.Origin);
            //system.debug('setting.Origin ' + emailCaseNumber.Entry_Source__c);
            //system.debug('emailCaseNumber.Last_Value__c ' + emailCaseNumber.Last_Value__c);
            if(caseRecord.Origin != null && caseRecord.Origin.equalsIgnoreCase(emailCaseNumber.Entry_Source__c) && emailCaseNumber.Last_Value__c != null){
                String autoNumberString = emailCaseNumber.Last_Value__c.substringAfterLast('-');
                autoNumberString = autoNumberString.trim();
                autoNumber = Decimal.valueOf(autoNumberString);
                String autogenerated = String.valueOf(Integer.valueOf(autoNumber) + 1);
                autogenerated = autogenerated.leftPad(8,'0');

                caseRecord.Tech_Case_Number__c = emailCaseNumber.Prefix__c + '-' + autogenerated;
                //system.debug('caseRecord.Tech_Case_Number__c ' + caseRecord.Tech_Case_Number__c);
            }
            else if(caseRecord.Origin != null && caseRecord.Origin.equalsIgnoreCase(phoneCaseNumber.Entry_Source__c) && phoneCaseNumber.Last_Value__c != null){
                String autoNumberString = phoneCaseNumber.Last_Value__c.substringAfterLast('-');
                autoNumberString = autoNumberString.trim();
                autoNumber = Decimal.valueOf(autoNumberString);
                String autogenerated = String.valueOf(Integer.valueOf(autoNumber) + 1);
                autogenerated = autogenerated.leftPad(8,'0');

                caseRecord.Tech_Case_Number__c = phoneCaseNumber.Prefix__c + '-' + autogenerated;
                //system.debug('caseRecord.Tech_Case_Number__c ' + caseRecord.Tech_Case_Number__c);

            }
            else if(caseRecord.Origin != null && caseRecord.Origin.equalsIgnoreCase(webCaseEmail.Entry_Source__c) && webCaseEmail.Last_Value__c != null){
                system.debug('Web Case Email ' + caseRecord.Origin == webCaseEmail.Entry_Source__c);
                system.debug('Web Case Email Last_Value__c ' + webCaseEmail.Last_Value__c);
                String autoNumberString = webCaseEmail.Last_Value__c.substringAfterLast('-');
                autoNumberString = autoNumberString.trim();
                autoNumber = Decimal.valueOf(autoNumberString);
                String autogenerated = String.valueOf(Integer.valueOf(autoNumber) + 1);
                autogenerated = autogenerated.leftPad(8,'0');

                caseRecord.Tech_Case_Number__c = webCaseEmail.Prefix__c + '-' + autogenerated;
                //system.debug('caseRecord.Tech_Case_Number__c ' + caseRecord.Tech_Case_Number__c);

            }
            else if(caseRecord.Origin != null && caseRecord.Origin.equalsIgnoreCase(walkInCaseNumber.Entry_Source__c) && walkInCaseNumber.Last_Value__c != null){
                String autoNumberString = walkInCaseNumber.Last_Value__c.substringAfterLast('-');
                autoNumberString = autoNumberString.trim();
                autoNumber = Decimal.valueOf(autoNumberString);
                String autogenerated = String.valueOf(Integer.valueOf(autoNumber) + 1);
                autogenerated = autogenerated.leftPad(8,'0');

                caseRecord.Tech_Case_Number__c = walkInCaseNumber.Prefix__c + '-' + autogenerated;
                //system.debug('caseRecord.Tech_Case_Number__c ' + caseRecord.Tech_Case_Number__c);

            }
            else if(caseRecord.Origin == null && manualCaseNumber.Last_Value__c != null){
                String autoNumberString = manualCaseNumber.Last_Value__c.substringAfterLast('-');
                autoNumber = Decimal.valueOf(autoNumberString);
                String autogenerated = String.valueOf(Integer.valueOf(autoNumber) + 1);
                autogenerated = autogenerated.leftPad(8,'0');

                caseRecord.Tech_Case_Number__c = walkInCaseNumber.Prefix__c + '-' + autogenerated;
            }
            
        } 
    }
}